<!DOCTYPE html>
<html>
<!--
    Instruktioner:
    1. Öppna i webbläsare
    2. Kopiera data
    3. spara till fil
    4. konvertera filen från utf-8 till iso-8859-1
    5. konvertera till dos line endings från unix line endings
-->
<head>
<style>
table {
  border-collapse: collapse;
}
td,
th {
  border: 1px solid black;
  padding: 10px 20px;
}

/*
pre {
    display: none;
}
*/
</style>
<meta charset="utf-8">
<script src="tools.js" defer="defer"></script>
<!-- papaparse not really needed but can be useful to have it loaded if running from console -->
<script src="papaparse.min.js" defer="defer"></script>
<script src="../protokoll_data.js" defer="defer"></script>
<script>
// let utrstr be a global...
csvstr = "";

function genCSV() {
    // a = document.getElementById("a");
    let a = document.getElementById("a");

    csvstr = genIHCSVstr(protokoll);

    a.innerText = csvstr;
}


function info() {
    let infostr = "";
    infostr += "Datan här är i utf-8 med unix line-endings. Den måste konverteras till iso-8859-1 och dos line-endings för att få rätt format för omnivis.\n";
    infostr += "Det kan göras i en texteditor (tex Notepad++), online (som tex här: https://www.freeformatter.com/convert-file-encoding.html eller ";
    infostr += "här https://www.charset.org/utf8-to-latin-converter ). \n"    
    infostr += "Det som finns också flera vertyg för att göra det.";
    alert(infostr);
}


function redraw() {
    document.getElementById("a").textContent = "";
    genCSV();
}


function save() {
    downloadBlob(csvstr, 'InjHast-new.txt', 'text/plain;charset=utf-8;');
}
</script>
</head>
<body onload="genCSV();info();">
Detta html-"script" konverterar aktuell protokolldata till en csv-fil i "InjHast.txt"-formatet. Eventuella kommentarer försvinner därför.<br/>
Filen kan sedan läsas t.ex. med <a href="ih2prot.html" target="_blank">ih2prot.html</a> men huvudsyftet är att generera en csv-fil som kan användas med Omniject.<br/>
Kopiera texten som visas på sidan nedom linjen, kopiera in den i en texteditor, och spara filen, eller klicka på spara-knappen.<br/>
Oberoende av vilket så måste du sedan tillse att texten är i iso-8859-1-format (latin1) och med dos-radslut.<br/>
Det kan du ändra i en bra texteditor, som tex <a href="https://notepad-plus-plus.org/" target="_blank">Notepad++</a>.
<br/>
<br/>
<input type="button" value="save" onclick="save()"/>
<br/><br/>
<hr/>
<pre id="a">
</pre>
</body>
</html>

